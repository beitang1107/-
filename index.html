<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>✨ 专属星空烟花 ✨</title>
<style>
    /* 重置默认样式，设置黑色星空背景 */
    body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: #000; overflow: hidden; font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif; }
    canvas { display: block; }
    
    /* 居中显示的唯美文案 */
    #text-container {
        position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
        text-align: center; color: #fff; pointer-events: none; z-index: 10;
    }
    h1 {
        font-size: 3rem; font-weight: 300; letter-spacing: 5px; margin-bottom: 20px;
        /* 霓虹灯呼吸发光效果 */
        animation: pulse 2s infinite alternate;
    }
    p { 
        font-size: 1.2rem; color: #f0f0f0; line-height: 1.8; 
        text-shadow: 0 0 5px rgba(255,255,255,0.5); 
    }
    @keyframes pulse { 
        from { text-shadow: 0 0 10px #fff, 0 0 20px #fff, 0 0 30px #e60073; } 
        to { text-shadow: 0 0 20px #fff, 0 0 30px #ff4da6, 0 0 40px #ff4da6; } 
    }
    
    /* 底部提示文字 */
    #hint { 
        position: absolute; bottom: 30px; width: 100%; text-align: center; 
        color: rgba(255,255,255,0.6); font-size: 0.9rem; pointer-events: none; 
    }
</style>
</head>
<body>

<div id="text-container">
    <h1>万事胜意 · 岁岁平安</h1>
    <p>所期皆所念，所念皆所愿</p>
    <p>所愿皆所得，所得皆所盼</p>
</div>
<div id="hint">✨ 点击或触摸屏幕任意位置燃放烟花 ✨</div>

<canvas id="canvas"></canvas>

<script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    // 窗口大小改变时自适应
    window.addEventListener('resize', () => {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    });

    function random(min, max) { return Math.random() * (max - min) + min; }

    // 烟花爆炸后的粒子类（加入物理重力和摩擦力）
    class Particle {
        constructor(x, y, hue) {
            this.x = x; this.y = y;
            this.coordinates = [];
            this.coordinateCount = 5;
            while(this.coordinateCount--) this.coordinates.push([this.x, this.y]);
            this.angle = random(0, Math.PI * 2);
            this.speed = random(1, 10);
            this.friction = 0.95; // 摩擦力
            this.gravity = 1;    // 重力下坠
            this.hue = random(hue - 20, hue + 20); // 随机颜色偏移
            this.brightness = random(50, 80);
            this.alpha = 1;
            this.decay = random(0.015, 0.03); // 消失速度
        }
        update(index) {
            this.coordinates.pop();
            this.coordinates.unshift([this.x, this.y]);
            this.speed *= this.friction;
            this.x += Math.cos(this.angle) * this.speed;
            this.y += Math.sin(this.angle) * this.speed + this.gravity;
            this.alpha -= this.decay;
            if(this.alpha <= this.decay) particles.splice(index, 1);
        }
        draw() {
            ctx.beginPath();
            ctx.moveTo(this.coordinates[this.coordinates.length - 1][0], this.coordinates[this.coordinates.length - 1][1]);
            ctx.lineTo(this.x, this.y);
            ctx.strokeStyle = `hsla(${this.hue}, 100%, ${this.brightness}%, ${this.alpha})`;
            ctx.stroke();
        }
    }

    // 升空的烟花类
    class Firework {
        constructor(sx, sy, tx, ty) {
            this.x = sx; this.y = sy;
            this.sx = sx; this.sy = sy;
            this.tx = tx; this.ty = ty;
            this.distanceToTarget = Math.sqrt(Math.pow(tx - sx, 2) + Math.pow(ty - sy, 2));
            this.distanceTraveled = 0;
            this.coordinates = [];
            this.coordinateCount = 3;
            while(this.coordinateCount--) this.coordinates.push([this.x, this.y]);
            this.angle = Math.atan2(ty - sy, tx - sx);
            this.speed = 2;
            this.acceleration = 1.05;
            this.brightness = random(50, 70);
        }
        update(index) {
            this.coordinates.pop();
            this.coordinates.unshift([this.x, this.y]);
            this.speed *= this.acceleration;
            let vx = Math.cos(this.angle) * this.speed;
            let vy = Math.sin(this.angle) * this.speed;
            this.distanceTraveled = Math.sqrt(Math.pow(this.x - this.sx + vx, 2) + Math.pow(this.y - this.sy + vy, 2));
            
            if(this.distanceTraveled >= this.distanceToTarget) {
                createParticles(this.tx, this.ty);
                fireworks.splice(index, 1);
            } else {
                this.x += vx; this.y += vy;
            }
        }
        draw() {
            ctx.beginPath();
            ctx.moveTo(this.coordinates[this.coordinates.length - 1][0], this.coordinates[this.coordinates.length - 1][1]);
            ctx.lineTo(this.x, this.y);
            ctx.strokeStyle = `hsl(${hue}, 100%, ${this.brightness}%)`;
            ctx.stroke();
        }
    }

    let fireworks = [];
    let particles = [];
    let hue = 120;
    let timerTotal = 60; // 自动发射间隔
    let timerTick = 0;

    function createParticles(x, y) {
        let particleCount = 120; // 爆炸后的粒子数量，数值越大越绚丽
        while(particleCount--) particles.push(new Particle(x, y, hue));
    }

    function loop() {
        requestAnimationFrame(loop);
        hue += 0.5; // 颜色随时间渐变
        
        // 制造拖尾效果
        ctx.globalCompositeOperation = 'destination-out';
        ctx.fillStyle = 'rgba(0, 0, 0, 0.5)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.globalCompositeOperation = 'lighter';

        let i = fireworks.length;
        while(i--) { fireworks[i].draw(); fireworks[i].update(i); }
        let j = particles.length;
        while(j--) { particles[j].draw(); particles[j].update(j); }

        // 自动随机发射烟花
        if(timerTick >= timerTotal) {
            if(Math.random() > 0.2) {
                fireworks.push(new Firework(canvas.width / 2, canvas.height, random(0, canvas.width), random(0, canvas.height / 2)));
            }
            timerTick = 0;
        } else { timerTick++; }
    }

    // 鼠标点击和手机触摸发射烟花
    canvas.addEventListener('click', (e) => {
        fireworks.push(new Firework(canvas.width / 2, canvas.height, e.clientX, e.clientY));
    });
    canvas.addEventListener('touchstart', (e) => {
        e.preventDefault();
        fireworks.push(new Firework(canvas.width / 2, canvas.height, e.touches[0].clientX, e.touches[0].clientY));
    }, {passive: false});

    window.onload = loop;
</script>
</body>
</html>